<div class="row g-5 mx-3 my-4 bg-white rounded-3">
    <div class="my-3 d-flex justify-content-between mx-2">
        <h5 class="fw-bold m-0">User Profile</h5>
        <button (click)="updateUserData()" ejs-button class="e-danger fs-6 mb-2 py-2 rounded-3">Update Profile</button>
    </div>
</div>
<div *ngIf="user" class="row gap-4 g-5 mx-3 my-1">
    <div class="my-2 left-col-width d-flex flex-column gap-3 px-0">
        <div class="d-flex flex-column bg-white rounded-3">    
            <div class="d-flex flex-column gap-3 align-items-center px-3 py-3 border-bottom border-dull-white">
                <div class="position-relative">
                    <img  style="width: 100px; height: 100px; object-fit: cover; border-radius: 6px;" [src]="user.ImgUrl ? user.ImgUrl : '../../../../../../assets/user-profile.png'"/>
                    <button *ngIf="user.ImgUrl !== null" (click)="removeImg()" class="remove-btn">
                        <span class="position-relative fs-6 text-white" style="top: -2.5px; right: 0px;"> x </span>
                    </button>
                </div>
                <label for="ImageInput" *ngIf="user.ImgUrl === null" class="z-2 cursor-pointer rounded-3 text-white gap-2 image-btn d-flex justify-content-center align-items-center">
                    <span class="cursor-pointer e-icons e-plus"></span>
                    <label class="cursor-pointer fw-bold w-full"  >Image</label>
                    <input (change)="onImageSelected($event)" id="ImageInput" type="file" accept="Image/*" hidden />
                </label>
            </div>
            <div class="my-3">
                <div class="border-bottom border-dull-white d-flex justify-content-between align-items-center gap-3">
                    <h5 *ngIf="isTeacher" class="px-3 fw-bolder text-muted-dark mb-3"> Personal Information  </h5>
                    <h5 *ngIf="isStudent" class="px-3 fw-bolder text-muted-dark mb-2"> <a class="cursor-pointer" [ngClass]="{'text-primary': StudentInfo, 'text-hover': !StudentInfo }" (click)="StudentInfo = true" >Personal</a> | <a [ngClass]="{'text-primary': !StudentInfo, 'text-hover':StudentInfo }" (click)="StudentInfo = false" class="cursor-pointer">Parental</a> Information </h5>
                    <!-- <button (click)="openEditProfileDialog()" ejs-button class="e-danger mx-3 mb-3 px-4 py-2 rounded-3 ">Edit</button> -->
                </div>
                <div class="d-flex flex-row flex-wrap justify-content-between gap-3 fw-bold mt-2 px-3">
                    <div *ngIf="isTeacher" class="text-start text-muted d-flex flex-column input-part-width">
                        <p class="col-md-12" >Hon,(Mr,Ms, Sir)</p>
                        <input class="form-control" [(ngModel)]="user.Hon" />
                    </div>
                    <div class="text-start text-muted d-flex flex-column input-part-width">
                        <p class="col-md-12" >Name</p>
                        <input class="form-control" [(ngModel)]="user.Name" />
                    </div>
                    <div *ngIf="isStudent && StudentInfo" class="text-start text-muted d-flex flex-column input-part-width">
                        <p class="col-md-12" >School Grade</p>
                        <input class="form-control" [(ngModel)]="user.SchoolGrade" />
                    </div>
                    <div class="text-start text-muted d-flex col-md-12 flex-column">
                        <p class="col-md-12" >Email</p>
                        <input class="form-control" [(ngModel)]="user.Email" />
                    </div>
                    <div *ngIf="isTeacher" class="text-start text-muted d-flex input-part-width flex-column">
                        <p class="col-md-12" >Degree</p>
                        <input class="form-control" [(ngModel)]="user.Degree" />
                    </div>
                    <div *ngIf="isTeacher" class="text-start text-muted d-flex input-part-width flex-column">
                        <p class="col-md-12" >One line Title</p>
                        <input class="form-control" [(ngModel)]="user.Title" />
                    </div>
                    <div class="text-start text-muted d-flex col-md-12 flex-column">
                        <p class="col-md-12" > Address</p>
                        <input class="form-control" [(ngModel)]="user.Address" />
                    </div>
                    <div class="text-start text-muted d-flex flex-column input-part-width">
                        <p class="col-md-12" >Phone Number </p>
                        <input class="form-control" [(ngModel)]="user.PhoneNumber" />
                    </div>
                    <div class="text-start text-muted d-flex flex-column input-part-width" >
                        <p class="col-md-12" >Country</p>
                        <input class="form-control" [(ngModel)]="user.Country" />
                    </div>
                    <div class="text-start text-muted d-flex flex-column input-part-width">
                        <p class="col-md-12" >City</p>
                        <input class="form-control" [(ngModel)]="user.City" />
                    </div>
                    <div class="text-start text-muted d-flex flex-column input-part-width">
                        <p class="col-md-12" > Postal Code</p>
                        <input class="form-control" [(ngModel)]="user.PostCode" />
                    </div>  
                    <div class="text-start text-muted d-flex flex-column col-md-12">
                        <p class="col-md-12" >About Me</p>
                        <textarea style="height: 90px; resize: none;" class="form-control" [(ngModel)]="user.AboutMe"></textarea>
                    </div>
                    <div *ngIf="TutorSubjectAndGrades.length > 0" class="d-flex flex-column col-md-12">
                        <p class="col-md-12 text-start text-muted" >Your Selected Subjects </p>
                        <div class="d-flex subject-row-overflow flex-row gap-3">
                            <div *ngFor="let subject of TutorSubjectAndGrades; let i = index" class="d-flex flex-column col-md-4">
                                <div  class="form-group">
                                    <label class="form-label">Core Subject </label>
                                    <ejs-dropdownlist [enabled]="false" [(value)]="subject.CoreSubject.Id" [fields]="{text:'Name', value:'Id'}" [dataSource]="CoreSubjects" [placeholder]="'Select Core Subject'" ></ejs-dropdownlist>
                                </div>
                                <div *ngIf="subject.isEditable" class="form-group">
                                    <label class="form-label">Subject</label>
                                    <ejs-dropdownlist (change)="updationOnSubject($event)" [(value)]="subject.SubSubject.value" [fields]="{text:'label', value:'value'}" [dataSource]="subSubjectUpdation" [placeholder]="'Select Subject'" ></ejs-dropdownlist>
                                </div>
                                <div class="form-group">
                                    <label class="form-label">Grades</label>
                                    <ejs-multiselect [enabled]="filterGradesForUpdation.length > 0 && subject.isEditable" (change)="updationOnGrades($event)" [(value)]="subject.Grades" [dataSource]="filterGradesForUpdation" [fields]="{text:'label', value:'value'}" [mode]="mode" [placeholder]="'Select Grade(s)'" ></ejs-multiselect>
                                </div>
                                <div class="my-2">
                                    <button ejs-button [disabled]="subject.isEditable == false" class="e-danger w-50 py-2 rounded-start-2 rounded-end-0"(click)="callSubSubjectForUpdate(subject.CoreSubject.Id, i)"> Edit Subject </button>
                                    <button ejs-button [disabled]="subject.isEditable == false" class="bg-white w-50 py-2 rounded-end-2 rounded-start-0"(click)="updateSubject(i)" > Save Subject </button>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="text-start text-muted d-flex flex-column col-md-12">
                        <p class="col-md-12">Select Subject</p>
                        <button (click)="subjectBox()" ejs-button class="e-danger col-md-2 rounded-2"> Add Subject </button>
                    </div>
                    <div class="d-flex flex-column col-md-12" *ngIf="subjectDrop" >
                        <div class="d-flex col-md-12 mb-2">
                            <button ejs-button (click)="filterSubjects('Primary')" [ngClass]=" activeType === 'Primary' ? 'e-danger' : ''" class="w-100">Primary</button>
                            <button ejs-button (click)="filterSubjects('Secondary')" [ngClass]="activeType === 'Secondary' ? 'e-danger' : ''" class="w-100">Secondary</button>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Core Subject</label>
                            <ejs-dropdownlist [enabled]='subjectTypeSelection.length > 0' (change)="getSubSubjects($event)" [fields]="{text:'label', value:'value'}" [dataSource]="subjectTypeSelection" [placeholder]="'Select Core Subject'" ></ejs-dropdownlist>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Subject</label>
                            <ejs-dropdownlist (change)="selectSubSubject($event)" [enabled]="subSubjects.length > 0" [dataSource]="subSubjects" [fields]="{text:'label', value:'value'}" [placeholder]="'Select Subject'" ></ejs-dropdownlist>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Grades</label>
                            <ejs-multiselect [(ngModel)]="selectedGrades" [enabled]="filterGrades.length > 0" [mode]="mode" [fields]="{text:'label', value:'value'}" [dataSource]="filterGrades" [placeholder]="'Select Grade(s)'" ></ejs-multiselect>
                        </div>
                        <div class="my-2">
                            <button [disabled]="!AddSubject.SubjectId || selectedGrades.length <= 0" ejs-button class="e-danger w-100 py-2 rounded-2" (click)="saveSubject()"> Save Subject </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div *ngIf="isTeacher" class="d-flex flex-column bg-white pt-2 rounded-3">
            <div class="border-bottom border-dull-white d-flex justify-content-between py-2 align-items-center gap-3">
                <h5 class="px-3 fw-bolder text-muted-dark mb-3">Qualifications</h5>
            </div>
            <div class="col-md-12">
                <ejs-richtexteditor [toolbarSettings]="tools" [quickToolbarSettings]="quickTools" [(ngModel)]="user.Qualifications" ></ejs-richtexteditor>
            </div>
        </div>
        <div *ngIf="isTeacher" class="d-flex flex-column bg-white pt-2 rounded-3">
            <div class="border-bottom border-dull-white d-flex justify-content-between py-2 align-items-center gap-3">
                <h5 class="px-3 fw-bolder text-muted-dark mb-3">Work History</h5>
            </div>
            <div class="col-md-12">
                <ejs-richtexteditor [toolbarSettings]="tools" [quickToolbarSettings]="quickTools" [(ngModel)]="user.WorkHistory" ></ejs-richtexteditor>
            </div>
        </div>
    </div>
    <div class="right-col-width d-flex flex-column gap-3 px-0 my-2">
        <div class="bg-white px-0 py-2 bg-white rounded-3">
            <div class="border-bottom border-dull-white d-flex py-2 align-items-center gap-3">
                <h5 class="px-3 fw-bolder text-muted-dark mb-3"> Change Password </h5>
            </div>
            <div class="px-3 d-flex gap-4 flex-column">
                <div class="form-group">
                    <label class="form-label col-form-label-lg">Current Password</label>
                    <input placeholder="Enter Current Password"  type="password" class="form-control"/>
                </div>
                <div class="form-group">
                    <label class="form-label col-form-label-lg">New Password</label>
                    <input placeholder="Enter New Password" type="password" class="form-control"/>
                </div>
                <div class="form-group">
                    <label class="form-label col-form-label-lg">Re-Enter Password</label>
                    <input placeholder="Re Enter New Password" type="password" class="form-control"/>
                </div>
                <div>
                    <button ejs-button class="e-danger fs-6 w-100 mb-2 py-2 rounded-3">Change Password</button>
                </div>
            </div>
        </div>
        <div *ngIf="isTeacher" class="bg-white px-0 pt-2 bg-white rounded-3">
            <div class="border-bottom border-dull-white d-flex py-2 gap-3">
                <h5 class="px-3 fw-bolder text-muted-dark mb-3"> Certification </h5>
            </div>
            <div class="col-md-12">
                <ejs-richtexteditor id='rteTool' [toolbarSettings]="tools" [quickToolbarSettings]="quickTools" [(ngModel)]="user.Certification" ></ejs-richtexteditor>
            </div>
        </div>
        <div class="bg-white px-0 py-2 bg-white rounded-3" >
            <div class="border-bottom border-dull-white d-flex py-2 gap-3">
                <h5 class="px-3 fw-bolder text-muted-dark mb-3"> Previously Held Meetings </h5>
            </div>
            <div class="px-3 d-flex gap-4 py-3 flex-column handle-meeting-scroll">
               <div class="d-flex flex-column" *ngFor="let meeting of meetings">
                    <div class="d-flex justify-content-between">
                        <p class="text-start  form-label mb-0 col-md-6">Title</p>
                        <p class="text-start text-muted-dark mb-0 fw-semibold col-md-6">{{meeting.Topic}}</p>
                    </div>
                    <div class="d-flex justify-content-between">
                        <p class="text-start form-label mb-0 col-md-6">Start Time</p>
                        <p class="text-start text-muted-dark mb-0 fw-semibold col-md-6">{{meeting.StartTime | date: 'yyyy/MM/dd HH:mm' }}</p>
                    </div>
                    <div class="d-flex justify-content-between">
                        <p class="text-start form-label mb-0 col-md-6">Meeting ID</p>
                        <p class="text-start text-muted-dark mb-0 fw-semibold col-md-6">{{meeting.MeetingId}}</p>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- <ejs-dialog *ngIf="user" [header]='headerTemplate' [width]="700" [visible]="UserEditProfileDialog" [showCloseIcon]="true" (close)="this.UserEditProfileDialog = false" [isModal]="true" > 
    <ng-template #headerTemplate>
        <h5 class="fw-bold text-muted-dark mb-2">Edit Profile</h5>
    </ng-template>
    <div class="row col-md-12 py-3 justify-content-between">
        <div class="mb-2 col-md-4 form-group" [ngClass]="{'col-md-6': !StudentInfo}"  >
            <label class="form-label"> {{!StudentInfo ? 'Parent' : ''}} Hon (Mr, Ms, Sir)</label>
            <input *ngIf="StudentInfo || isTeacher" class="form-control" [(ngModel)]="user.Hon" />
            <input *ngIf="!StudentInfo" class="form-control" [(ngModel)]="user.Parent" />
        </div>
        <div class="mb-2 col-md-4 form-group" [ngClass]="{'col-md-6': !StudentInfo}">
            <label class="form-label"> {{!StudentInfo ? 'Parent' : ''}} Name</label>
            <input *ngIf="StudentInfo || isTeacher"  [(ngModel)]="user.Name" class="form-control"/>
            <input *ngIf="!StudentInfo" [(ngModel)]="user.Parent" class="form-control"/>
        </div>
        <div *ngIf="isTeacher" class="mb-2 col-md-4 form-group">
            <label class="form-label">Qualification</label>
            <input *ngIf="!StudentInfo"  [(ngModel)]="user.Qualifications" class="form-control"/>
        </div>
        <div *ngIf="isStudent && StudentInfo" class="mb-2 col-md-4 form-group">
            <label class="form-label">School Grade</label>
            <input [(ngModel)]="user.SchoolGrade" class="form-control"/>
        </div>
        <div class="mb-2 col-md-6 form-group">
            <label class="form-label"> {{!StudentInfo ? 'Parent' : ''}} Email</label>
            <input *ngIf="StudentInfo || isTeacher"  [(ngModel)]="user.Email" class="form-control"/>
            <input *ngIf="!StudentInfo"  [(ngModel)]="user.Parent" class="form-control"/>
        </div>
        <div class="mb-2 col-md-6 form-group">
            <label class="form-label"> {{!StudentInfo ? 'Parent' : ''}} Phone Number</label>
            <input *ngIf="StudentInfo || isTeacher" [(ngModel)]="user.PhoneNumber" class="form-control"/>
            <input *ngIf="!StudentInfo" [(ngModel)]="user.Parent" class="form-control"/>
        </div>
        <div class="mb-2 form-group">
            <label class="form-label"> {{!StudentInfo ? 'Parent' : ''}} Address</label>
            <input *ngIf="StudentInfo || isTeacher" [(ngModel)]="user.Address" class="form-control"/>
            <input *ngIf="!StudentInfo" [(ngModel)]="user.Parent" class="form-control"/>
        </div>
        <div class="mb-2 col-md-6 form-group">
            <label class="form-label"> {{!StudentInfo ? 'Parent' : ''}} Country</label>
            <input *ngIf="StudentInfo || isTeacher" [(ngModel)]="user.Country" class="form-control"/>
            <input *ngIf="!StudentInfo" [(ngModel)]="user.Parent" class="form-control"/>
        </div>
        <div class="mb-2 col-md-6 form-group">
            <label class="form-label"> {{!StudentInfo ? 'Parent' : ''}} State</label>
            <input *ngIf="StudentInfo || isTeacher" [(ngModel)]="user.State" class="form-control"/>
            <input *ngIf="!StudentInfo"  [(ngModel)]="user.Parent" class="form-control"/>
        </div>
        <div class="mb-2 col-md-6 form-group">
            <label class="form-label"> {{!StudentInfo ? 'Parent' : ''}} City</label>
            <input *ngIf="StudentInfo || isTeacher" [(ngModel)]="user.City" class="form-control"/>
            <input *ngIf="!StudentInfo" [(ngModel)]="user.Parent" class="form-control"/>
        </div>
        <div class="mb-2 col-md-6 form-group">
            <label class="form-label"> {{!StudentInfo ? 'Parent' : ''}} Postal Code</label>
            <input *ngIf="StudentInfo || isTeacher" [(ngModel)]="user.PostCode" class="form-control"/>
            <input *ngIf="!StudentInfo" [(ngModel)]="user.Parent" class="form-control"/>
        </div>
        <div *ngIf="StudentInfo || isTeacher" class="mb-2 form-group">
            <label class="form-label">Subjects</label>
            <ejs-multiselect id="multiSubjectSelect" [(value)]="selectedSubjects" [allowObjectBinding]="true" [dataSource]="subjects" [fields]="{text:'label', value:'value'}" ></ejs-multiselect>
        </div>
    </div>
    <ng-template #footerTemplate>
        <button ejs-button class="e-danger py-2 rounded-3" (click)="updateUserData()"> Update Profile </button>
    </ng-template>
</ejs-dialog> -->