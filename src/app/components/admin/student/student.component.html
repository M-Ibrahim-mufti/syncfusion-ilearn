<!-- <div class="container">
    <div class="row">
        <div class="col-md-6">
            <h3 class="fw-normal">Students Data</h3>
        </div>
        <hr>
        <div class="col-md-12">
            <div class="card">
                <p-table
                    #dt1
                    dataKey="id"
                    [rows]="15"
                    [rowsPerPageOptions]="[15, 30, 60]"
                    [paginator]="students && students.length > 15"
                    [value]="students" 
                    [(selection)]="students"
                    selectionMode="single"
                    [globalFilterFields]="['FullName', 'Email', 'Parent.FullName', 'Parent.PhoneNumber']"
                    styleClass="p-datatable-striped"
                    >
                    <ng-template pTemplate="caption">
                        <div class="row justify-content-between">
                            <div class="col-md-6 my-1 d-flex">
                                <div class="input-group justify-content-end">
                                    <span class="input-group-text">
                                        <i class="pi pi-search"></i>
                                    </span>
                                    <input
                                    pInputText
                                    type="text"
                                    (input)="onInput($event)"
                                    placeholder="Search keyword"
                                    class="form-control"
                                    />
                                </div>
                            </div>
                        </div>                        
                    </ng-template>
                    <ng-template  pTemplate="header">
                        <tr class="text-center">
                            <th pSortableColumn="StudentFullName">Student<p-sortIcon field="StudentFullName"/></th>
                            <th pSortableColumn="StudentSchoolGrade">School Grade <p-sortIcon field="StudentSchoolGrade" /></th>
                            <th pSortableColumn="ParentFullName">Parent <p-sortIcon field="ParentFullName" /></th>
                            <th pSortableColumn="ParentPhoneNumber">Parent Contact Number <p-sortIcon field="ParentPhoneNumber" /></th>
                            <th pSortableColumn="ParentEmail">Parent Email <p-sortIcon field="ParentEmail" /></th>
                            <th>Actions</th>
                        </tr>
                    </ng-template>
                    <ng-template pTemplate="body" let-student let-index="rowIndex" let-last="last" >
                        <tr class="">
                            <td class="text-center"  width="25%" height="50px">
                                <div class="d-flex justify-content-center align-items-center">
                                    <img 
                                        [alt]="student.FullName"
                                        src="{{student.ImgUrl != null ? student.ImgUrl : '../../../../../../assets/user-profile.png' }}"
                                        style="width: 50px; height: 50px; object-fit: cover; border-radius: 50%; box-shadow: rgba(0, 0, 0, 0.4) 0px 30px 90px; "  
                                        class="mx-auto"
                                    />
                                    <div class="col-md-9 text-start">
                                        <span class="fw-bold">{{student.Hon }} {{ student.FullName }}</span><br/>
                                        <span class="text-muted">{{ student.Email }}</span><br/>
                                        <span class="text-left text-muted">{{ student.PhoneNumber }}</span>
                                    </div>
                                </div>
                            </td>                            
                            <td class="text-center" >
                                <span class="fs-7 ml-1 vertical-align-middle">{{ student.SchoolGrade }} </span>
                            </td>
                            <td class="text-center" >
                                <span class="fs-7 ml-1 vertical-align-middle">{{ student.Parent?.FullName }}</span>
                            </td>
                            <td class="text-center" >
                                <span class="fs-7 ml-1 vertical-align-middle">{{ student.Parent?.PhoneNumber }}</span>
                            </td>
                            <td class="text-center" >
                                <span class="fs-7 ml-1 vertical-align-middle">{{ student.Parent?.Email }}</span>
                            </td>
                            <td class="text-center">
                                <span class="ml-1 vertical-align-middle">
                                    <p-button icon="pi pi-ban" [outlined]="true" severity="danger" styleClass="rounded-circle" (click)="blockStudent(student)" />
                                </span>
                            </td>
                        </tr>
                    </ng-template>
                    <ng-template pTemplate="emptymessage">
                        <tr>
                            <td class="text-center" colspan="7">No customers found.</td>
                        </tr>
                    </ng-template>
                </p-table>
            </div>
        </div>
    </div>
</div> -->
<div *ngIf="students" class="row g-5 mx-3 my-4 my-2 bg-white rounded-3">
    <div class="d-flex border-bottom border-1 border-dull-white align-items-center justify-content-between pb-3 mb-3">
        <div class="d-flex align-items-center gap-2">
            <h4 class="text-dark fw-bold mb-0">Students</h4>
            <span *ngIf="students" class="fs-6 text-muted badge rounded-circle bg-secondary">{{students.length}}</span>
        </div>
    </div>
    <div class="col-md-12 mt-2 p-0">
        <ejs-grid id="Grid" cssClass="border-dull-white border-0" [dataSource]='students' [allowPaging]="students.length > 15" [pageSettings]="{ pageSize: 15 }" [allowSorting]="true">
            <e-columns>
                <e-column field="FullName" headerText='Student Info' width='150' textAlign='left' [headerTemplate]='headerTemplate ' [template]="cellTitleTemplate">
                    <ng-template #cellTitleTemplate let-data>
                        <div class="d-flex flex-row align-items-center gap-2">
                            <img class="tableImg" [src]="data.ImgUrl ? data.ImgUrl : '../../../../assets/user-profile.png'"/>
                            <div class="d-flex flex-column">
                                <span class="hover-primary text-dark fw-bold">{{data.FullName}}</span>
                                <span class="text-muted fw-bold">{{data.Email}}</span>
                                <span class="text-muted fw-bold"> {{data.PhoneNumber}} </span>
                            </div>
                        </div>
                    </ng-template>
                </e-column>
                <e-column field="Country" headerText='Location' width='150' textAlign='left' [headerTemplate]='headerTemplate ' [template]="cellLocationTemplate">
                    <ng-template #cellLocationTemplate let-data let-column>
                        <div class="d-flex flex-column">
                            <span class="hover-primary text-dark fw-bold">{{data.Country}}</span>
                            <span class="text-muted fw-bold">{{data.City}}</span>
                            <span class="text-muted fw-bold"> {{data.Address}} </span>
                        </div>
                    </ng-template>
                </e-column>
                <e-column field="Parent.FullName" headerText='Parent Info' width='150' textAlign='left' [headerTemplate]='headerTemplate ' [template]="cellParentTemplate">
                    <ng-template #cellParentTemplate let-data let-column>
                        <div class="d-flex flex-column">
                            <span class="hover-primary text-dark fw-bold">{{data.Parent.FullName}}</span>
                            <span class="text-muted fw-bold">{{data.Parent.Email}}</span>
                            <span class="text-muted fw-bold"> {{data.Parent.PhoneNumber}} </span>
                        </div>                    </ng-template>
                </e-column>
                <e-column field="null" headerText='Subjects' width='150' textAlign='left' [headerTemplate]='headerTemplate ' [template]="cellSubjectTemplate">
                    <ng-template #cellSubjectTemplate let-data let-column>
                        <div class="d-flex align-items-center">
                            <a (click)="viewSubjectBox(data.StudentSubjects)" class="fw-semibold cursor-pointer hover-primary text-dark"> View Subjects </a>
                        </div>
                    </ng-template>
                </e-column>
                <e-column headerText='Action' width='120' textAlign='center' [headerTemplate]='headerTemplate' [template]='actionTemplate'></e-column>
            </e-columns>
        </ejs-grid>
        <ng-template #headerTemplate let-column>
            <span class="text-muted-dark fw-bolder fs-6">{{column.headerText}}</span>
        </ng-template>
    </div>
</div>
<ng-template #actionTemplate let-data>
    <button ejs-button cssClass='e-info e-icon-btn me-2 rounded-circle'>
        <span class="e-btn-icon e-icons e-edit"></span>
    </button>
    <button (click)="blockStudent(data)" ejs-button cssClass='e-danger e-icon-btn rounded-circle'>
        <span class="e-btn-icon e-icons e-delete"></span>
    </button>
</ng-template>

<ejs-dialog cssClass="rounded-dialog" header="Student Subjects" [visible]="studentDialogue" [width]="430" [showCloseIcon]="true" [isModal]="true" (close)="studentDialogue = false"  >
    <div class="w-full d-flex flex-col border-bottom border-top border-1">
        <h5 class="px-3 py-2 text-muted-dark my-2">List of All student Subjects</h5>
    </div>
    <div  class="mx-3 mt-3 d-flex flex-row flex-wrap gap-3">
        <span class="px-3 py-1 rounded-pill bg-secondary" *ngFor="let subject of studentSubject">{{subject.Name}}</span>
    </div>
    <div *ngIf="studentSubject.length <= 0" class="mx-3 mt-3 d-flex flex-row flex-wrap gap-3">
        <span class="px-3 text-center">No Subject Found</span>
    </div>
</ejs-dialog>

