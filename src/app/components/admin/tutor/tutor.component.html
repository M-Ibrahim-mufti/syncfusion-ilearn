<div class="position-relative container">
    <div class="row">
        <div class="col-md-6">
            <h2 class="fw-normal">Tutors Data</h2>
        </div>
        <hr>
        <div class="col-md-12">
            <div class="card">
                <p-table
                    #dt1
                    dataKey="id"
                    [rows]="15"
                    [rowsPerPageOptions]="[15, 30, 60]"
                    [paginator]="tutors && tutors.length > 15"
                    [value]="tutors"
                    selectionMode="single"
                    [(selection)]="tutors"
                    [globalFilterFields]="['FullName', 'Email', 'PhoneNumber', 'Qualification']"
                    styleClass="p-datatable-striped"
                    >
                    <ng-template pTemplate="caption">
                        <div class="row justify-content-between">
                            <div class="d-flex col-md-6 ">
                                <div class="input-group">
                                    <span class="input-group-text">
                                        <i class="pi pi-search"></i>
                                    </span>
                                    <input
                                        pInputText
                                        type="text"
                                        (input)="onInput($event)"
                                        placeholder="Search keyword"
                                        class="form-control"
                                    />
                                </div>
                            </div>
                            <!-- <div class="col-md-auto">
                                <button type="button" pButton icon="fa fa-save" label="Add New" class="p-button-sm p-button-outlined"></button>
                            </div> -->
                        </div>                        
                    </ng-template>
                    <ng-template pTemplate="header">
                        <tr class="text-center">
                            <th pSortableColumn="FullName">Tutor<p-sortIcon field="FullName"/></th>
                            <th pSortableColumn="Qualification">Qualification <p-sortIcon field="Qualification" /></th>
                            <th pSortableColumn="Subjects">Subjects <p-sortIcon field="Subjects" /></th>
                            <th pSortableColumn="PhoneNumber">PhoneNumber<p-sortIcon field="PhoneNumber"/></th>
                            <th>Actions</th>
                        </tr>
                    </ng-template>
                    <ng-template pTemplate="body" let-tutor>
                        <tr>
                            <td width="25%" height="50px">
                                <div class="d-flex justify-content-center align-items-center">
                                    <img 
                                        [alt]="tutor.FullName"
                                        src="{{tutor.ImgUrl != null ? tutor.ImgUrl : '../../../../../../assets/user-profile.png' }}"
                                        style="width: 50px; height: 50px; object-fit: cover; border-radius: 50%"
                                        class="mx-auto" />
                                    <div class="col-md-9 text-start">
                                        <span class="fw-bold">{{tutor.Hon }} {{ tutor.FullName }}</span><br/>
                                        <span>{{ tutor.Email }}</span><br/>
                                        <span>{{ tutor.City }}, {{ tutor.Country }}</span>
                                    </div>
                                </div>
                            </td>                            
                            <td class="text-center">
                                <span class="ml-1 vertical-align-middle">{{ tutor.Qualifications }}</span>
                            </td>
                            <td class="text-center">
                                <p *ngIf="!tutor.TutorSubjects[0].SubjectName && tutor.TutorSubjects.length === 1 ">Not Found</p>
                                <a *ngIf="tutor.TutorSubjects[0].SubjectName || tutor.TutorSubjects.length > 1" (click)="showSubjectDialogueBox($event, tutor)" class="text-primart cursor-pointer">view Subjects</a>
                            </td>         
                            <td class="text-center">
                                <span>{{ tutor.PhoneNumber }}</span>
                            </td>                   
                            <td class="text-center">
                                <span class="ml-1 vertical-align-middle">
                                    <p-button icon="pi pi-ban" [outlined]="true" severity="danger" styleClass="rounded-circle" />
                                </span>
                            </td>
                        </tr>
                    </ng-template>
                    <ng-template pTemplate="emptymessage">
                        <tr>
                            <td colspan="5">No customers found.</td>
                        </tr>
                    </ng-template>
                </p-table>
            </div>
        </div>
    </div>
</div>


<p-dialog header="Subjects" [modal]="true" [(visible)]="showSubjectDialogue" [style]="{width:'600px'}">  
    <div class="text-center " *ngIf="selectedTutor">
        <p>List of All subject {{(!selectedTutor.Hon ? "" : selectedTutor.Hon + ".") + " " + selectedTutor.FullName}} teaches</p>
    </div>
    <div class="mt-3 d-flex justify-content-around border border-2 rounded-top-2 ">
        <h5 class="w-50 text-center border border-2 border-top-0 border-bottom-0 border-start-0 mb-0">Subject Name</h5>
        <h5 class="w-50 text-center">Grades</h5>
    </div>
    <div class="d-flex flex-column border border-2 border-top-0 rounded-bottom-2 mb-3">
        <div class="d-flex justify-content-between" *ngFor="let subject of selectedTutorSubjects; let last = last" [ngClass]="{'border border-2 border-start-0 border-top-0 border-end-0': !last && subject.SubjectName}">
            <p *ngIf="subject.SubjectName" class="ps-3 w-50 border border-2 border-top-0 border-bottom-0 border-start-0 mb-0">{{subject.SubjectName}}</p>
            <div *ngIf="subject.SubjectName" class="ps-3 w-50 d-flex gap-3">
                <p *ngFor="let Grade of subject.Grades"> {{  Grade.GradeLevel > 3 ? Grade.GradeLevel + 'th' : Grade.GradeLevel === 1 ? Grade.GradeLevel + 'st' : Grade.GradeLevel === 2 ? Grade.GradeLevel + 'nd' : Grade.GradeLevel === 3 ? Grade.GradeLevel + 'rd': 'Not Found'  }}<p>
            </div>
        </div>
    </div>
    <div class="text-end">
        <p-button label="close" severity="primary" (click)="showSubjectDialogue = false" [style]="{borderRadius:'3px', width:'75px'}" />
    </div>
</p-dialog>

